<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

    <changeSet id="20250119-011" author="adalana">
        <comment>Update order status constraint to include cancelled_request_pending and cancelled_by_company</comment>

        <sql>
            ALTER TABLE [order] DROP CONSTRAINT ck_order_status;
            
            ALTER TABLE [order] ADD CONSTRAINT ck_order_status 
            CHECK (status IN ('pending', 'notified', 'confirmed', 'delivered', 'failed', 
                            'not_delivered_customer_absent', 'not_delivered_address_issue', 
                            'not_delivered_refused', 'cancelled_by_customer',
                            'cancelled_by_company', 'cancelled_request_pending', 'rejected'));
        </sql>

    </changeSet>

</databaseChangeLog>

